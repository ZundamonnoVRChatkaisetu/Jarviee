# 依存関係解決ドキュメント

## 問題概要

Jarvieeプロジェクトの依存関係において、以下の競合が発生していました：

- `ray[rllib]==2.6.3` は `pyarrow>=6.0.1,<7.0.0` に依存
- `datasets==2.15.0` は `pyarrow>=8.0.0` に依存

これにより、依存関係を解決できない状態になっていました。

## 解決策

依存関係の競合を解決するために、以下の変更を行いました：

1. **datasetsのバージョンダウン**：
   - 変更前: `datasets==2.15.0`
   - 変更後: `datasets==2.14.0`
   - 理由: 2.14.0バージョンはpyarrow 6.x系と互換性があります

2. **pyarrowの明示的な指定**：
   - `pyarrow==6.0.1` の指定を維持
   - 理由: ray[rllib]との互換性確保

## 代替解決策

以下の代替解決策も検討しましたが、今回は上記の方法を採用しました：

1. **ray[rllib]のバージョンアップ**：
   - 最新バージョンのray[rllib]はより新しいpyarrowバージョンをサポートしていますが、他の依存関係への影響が大きいため、避けました。

2. **pandas 3.0への備え**：
   - 将来的にpandas 3.0では、pyarrowが必須依存関係になる予定です。
   - その時点で再度依存関係を見直す必要があります。

## 実行コマンド

依存関係を適切にインストールするには、以下のコマンドを使用してください：

```bash
# 通常のインストール
uv pip install -r requirements.txt

# または直接pyarrowを指定してインストール
uv pip install "pyarrow==6.0.1" -r requirements.txt
```

## 関連情報

- Ray 2.6.3はpyarrow 6.0.1に特に依存しており、7.0以上のバージョンは互換性がありません。
- datasetsはバージョン2.14.0でも主要な機能は保持されています。
- 将来的なアップデートでRayの最新バージョンへの移行も検討すべきです。
